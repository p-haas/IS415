<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pierre HAAS">
<meta name="dcterms.date" content="2023-02-03">

<title>IS415 - Take-home Exercise - Application of Spatial Point Patterns Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../site_libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="../site_libs/jquery-1.12.4/jquery.min.js"></script>
<link href="../site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="../site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="../site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="../site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="../site_libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="../site_libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="../site_libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">IS415</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-Class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../In-class_Ex/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-Class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-Class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-Class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-Class Exercise 5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../Take-home_Ex/Take-home_Ex1.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">1 - Introduction</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">2 - Data</a></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">3 - Getting Started</a>
  <ul class="collapse">
  <li><a href="#installing-and-loading-packages" id="toc-installing-and-loading-packages" class="nav-link" data-scroll-target="#installing-and-loading-packages">3.1 - Installing and Loading Packages</a></li>
  </ul></li>
  <li><a href="#handling-geospatial-data" id="toc-handling-geospatial-data" class="nav-link" data-scroll-target="#handling-geospatial-data">4 - Handling Geospatial Data</a>
  <ul class="collapse">
  <li><a href="#importing-aspatial-data-csv-format" id="toc-importing-aspatial-data-csv-format" class="nav-link" data-scroll-target="#importing-aspatial-data-csv-format">4.1 - Importing Aspatial Data, <em>csv</em> format</a>
  <ul class="collapse">
  <li><a href="#converting-water-point-data-into-sf-point-features" id="toc-converting-water-point-data-into-sf-point-features" class="nav-link" data-scroll-target="#converting-water-point-data-into-sf-point-features">4.1.1 - Converting water point data into <em>sf</em> point features</a></li>
  <li><a href="#transforming-into-nigeria-projected-coordinate-system" id="toc-transforming-into-nigeria-projected-coordinate-system" class="nav-link" data-scroll-target="#transforming-into-nigeria-projected-coordinate-system">4.1.2 - Transforming into Nigeria projected coordinate system</a></li>
  </ul></li>
  <li><a href="#importing-geospatial-data-shp-format" id="toc-importing-geospatial-data-shp-format" class="nav-link" data-scroll-target="#importing-geospatial-data-shp-format">4.2 - Importing Geospatial Data, <em>shp</em> format</a>
  <ul class="collapse">
  <li><a href="#the-nga-data-set" id="toc-the-nga-data-set" class="nav-link" data-scroll-target="#the-nga-data-set">4.2.1 - The NGA data set</a></li>
  <li><a href="#the-geoboundaries-data-set" id="toc-the-geoboundaries-data-set" class="nav-link" data-scroll-target="#the-geoboundaries-data-set">4.2.2 - The geoBoundaries data set</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data-cleaning-wrangling" id="toc-data-cleaning-wrangling" class="nav-link" data-scroll-target="#data-cleaning-wrangling">5 - Data Cleaning &amp; Wrangling</a>
  <ul class="collapse">
  <li><a href="#geospatial-data-cleaning" id="toc-geospatial-data-cleaning" class="nav-link" data-scroll-target="#geospatial-data-cleaning">5.1 - Geospatial Data Cleaning</a>
  <ul class="collapse">
  <li><a href="#excluding-redundant-fields" id="toc-excluding-redundant-fields" class="nav-link" data-scroll-target="#excluding-redundant-fields">5.1.1 - Excluding redundant fields</a></li>
  <li><a href="#checking-for-duplicated-name" id="toc-checking-for-duplicated-name" class="nav-link" data-scroll-target="#checking-for-duplicated-name">5.1.2 - Checking for duplicated name</a></li>
  </ul></li>
  <li><a href="#data-wrangling-for-water-point-data" id="toc-data-wrangling-for-water-point-data" class="nav-link" data-scroll-target="#data-wrangling-for-water-point-data">5.2 - Data Wrangling for Water Point Data</a>
  <ul class="collapse">
  <li><a href="#extracting-water-point-data" id="toc-extracting-water-point-data" class="nav-link" data-scroll-target="#extracting-water-point-data">5.2.1 - Extracting water point data</a></li>
  <li><a href="#performing-point-in-polygon-count" id="toc-performing-point-in-polygon-count" class="nav-link" data-scroll-target="#performing-point-in-polygon-count">5.2.2 - Performing Point-in-Polygon Count</a></li>
  </ul></li>
  <li><a href="#converting-sf-data-frames-to-sps-spatial-class" id="toc-converting-sf-data-frames-to-sps-spatial-class" class="nav-link" data-scroll-target="#converting-sf-data-frames-to-sps-spatial-class">5.3 - Converting <em>sf</em> data frames to <em>sp’s</em> Spatial* class</a></li>
  <li><a href="#converting-the-spatial-class-into-generic-sp-format" id="toc-converting-the-spatial-class-into-generic-sp-format" class="nav-link" data-scroll-target="#converting-the-spatial-class-into-generic-sp-format">5.4 - Converting the Spatial* class into generic <em>sp</em> format</a></li>
  <li><a href="#converting-the-generic-sp-format-into-spatstats-ppp-format" id="toc-converting-the-generic-sp-format-into-spatstats-ppp-format" class="nav-link" data-scroll-target="#converting-the-generic-sp-format-into-spatstats-ppp-format">5.5 - Converting the generic <em>sp</em> format into <em>spatstat’s</em> ppp format</a></li>
  <li><a href="#creating-owin-object" id="toc-creating-owin-object" class="nav-link" data-scroll-target="#creating-owin-object">5.6 - Creating <em>owin</em> object</a></li>
  <li><a href="#combining-point-events-object-and-owin-object" id="toc-combining-point-events-object-and-owin-object" class="nav-link" data-scroll-target="#combining-point-events-object-and-owin-object">5.7 Combining point events object and <em>owin</em> object</a></li>
  </ul></li>
  <li><a href="#exploratory-spatial-data-analysis" id="toc-exploratory-spatial-data-analysis" class="nav-link" data-scroll-target="#exploratory-spatial-data-analysis">6 - Exploratory Spatial Data Analysis</a>
  <ul class="collapse">
  <li><a href="#kernel-density-estimation" id="toc-kernel-density-estimation" class="nav-link" data-scroll-target="#kernel-density-estimation">6.1 - Kernel Density Estimation</a>
  <ul class="collapse">
  <li><a href="#rescalling-kde-values" id="toc-rescalling-kde-values" class="nav-link" data-scroll-target="#rescalling-kde-values">6.1.1 - Rescalling KDE values</a></li>
  <li><a href="#convert-kde-output-into-grid-object" id="toc-convert-kde-output-into-grid-object" class="nav-link" data-scroll-target="#convert-kde-output-into-grid-object">6.1.2 - Convert KDE output into grid object</a></li>
  <li><a href="#converting-grid-object-into-raster" id="toc-converting-grid-object-into-raster" class="nav-link" data-scroll-target="#converting-grid-object-into-raster">6.1.3 - Converting grid object into raster</a></li>
  <li><a href="#assigning-projection-systems" id="toc-assigning-projection-systems" class="nav-link" data-scroll-target="#assigning-projection-systems">6.1.4 - Assigning projection systems</a></li>
  </ul></li>
  <li><a href="#visualizing-kde-with-tmap" id="toc-visualizing-kde-with-tmap" class="nav-link" data-scroll-target="#visualizing-kde-with-tmap">6.2 - Visualizing KDE with tmap</a></li>
  <li><a href="#nearest-neighbor-index" id="toc-nearest-neighbor-index" class="nav-link" data-scroll-target="#nearest-neighbor-index">6.3 - Nearest Neighbor Index</a>
  <ul class="collapse">
  <li><a href="#test-1-on-functional-water-points" id="toc-test-1-on-functional-water-points" class="nav-link" data-scroll-target="#test-1-on-functional-water-points">6.3.1 - Test 1 on functional water points</a></li>
  <li><a href="#test-2-on-non-functional-water-points" id="toc-test-2-on-non-functional-water-points" class="nav-link" data-scroll-target="#test-2-on-non-functional-water-points">6.3.2 - Test 2 on non-functional water points</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">6.3.3 - Conclusion</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#second-order-spatial-point-patterns-analysis" id="toc-second-order-spatial-point-patterns-analysis" class="nav-link" data-scroll-target="#second-order-spatial-point-patterns-analysis">7 - Second-order Spatial Point Patterns Analysis</a>
  <ul class="collapse">
  <li><a href="#formulate-the-null-hypothesis-and-alternative-hypothesis-and-select-the-confidence-level" id="toc-formulate-the-null-hypothesis-and-alternative-hypothesis-and-select-the-confidence-level" class="nav-link" data-scroll-target="#formulate-the-null-hypothesis-and-alternative-hypothesis-and-select-the-confidence-level">7.1 - Formulate the null hypothesis and alternative hypothesis and select the confidence level</a></li>
  <li><a href="#perform-the-test-by-using-appropriate-second-order-spatial-point-patterns-analysis-technique" id="toc-perform-the-test-by-using-appropriate-second-order-spatial-point-patterns-analysis-technique" class="nav-link" data-scroll-target="#perform-the-test-by-using-appropriate-second-order-spatial-point-patterns-analysis-technique">7.2 - Perform the test by using appropriate Second order spatial point patterns analysis technique</a></li>
  <li><a href="#with-reference-to-the-analysis-results-draw-statistical-conclusions" id="toc-with-reference-to-the-analysis-results-draw-statistical-conclusions" class="nav-link" data-scroll-target="#with-reference-to-the-analysis-results-draw-statistical-conclusions">7.3 - With reference to the analysis results, draw statistical conclusions</a></li>
  </ul></li>
  <li><a href="#spatial-correlation-analysis" id="toc-spatial-correlation-analysis" class="nav-link" data-scroll-target="#spatial-correlation-analysis">8 - Spatial Correlation Analysis</a>
  <ul class="collapse">
  <li><a href="#formulate-the-null-hypothesis-and-alternative-hypothesis-and-select-the-confidence-level-1" id="toc-formulate-the-null-hypothesis-and-alternative-hypothesis-and-select-the-confidence-level-1" class="nav-link" data-scroll-target="#formulate-the-null-hypothesis-and-alternative-hypothesis-and-select-the-confidence-level-1">8.1 - Formulate the null hypothesis and alternative hypothesis and select the confidence level</a></li>
  <li><a href="#perform-the-test-by-using-appropriate-second-order-spatial-point-patterns-analysis-technique-1" id="toc-perform-the-test-by-using-appropriate-second-order-spatial-point-patterns-analysis-technique-1" class="nav-link" data-scroll-target="#perform-the-test-by-using-appropriate-second-order-spatial-point-patterns-analysis-technique-1">8.2 - Perform the test by using appropriate Second order spatial point patterns analysis technique</a></li>
  <li><a href="#with-reference-to-the-analysis-results-draw-statistical-conclusions-1" id="toc-with-reference-to-the-analysis-results-draw-statistical-conclusions-1" class="nav-link" data-scroll-target="#with-reference-to-the-analysis-results-draw-statistical-conclusions-1">8.3 - With reference to the analysis results, draw statistical conclusions</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise - Application of Spatial Point Patterns Analysis</h1>
<p class="subtitle lead">Discover the geographical distribution of functional and non-function water points in Osun State, Nigeria</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pierre HAAS </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 3, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">February 6, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="introduction" class="level1">
<h1>1 - Introduction</h1>
</section>
<section id="data" class="level1">
<h1>2 - Data</h1>
</section>
<section id="getting-started" class="level1">
<h1>3 - Getting Started</h1>
<section id="installing-and-loading-packages" class="level2">
<h2 class="anchored" data-anchor-id="installing-and-loading-packages">3.1 - Installing and Loading Packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, tmap, funModeling, maptools, spatstat, tidyverse, raster, cowplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="handling-geospatial-data" class="level1">
<h1>4 - Handling Geospatial Data</h1>
<section id="importing-aspatial-data-csv-format" class="level2">
<h2 class="anchored" data-anchor-id="importing-aspatial-data-csv-format">4.1 - Importing Aspatial Data, <em>csv</em> format</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>wp_nga <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/Water_Point_Data_Exchange_-_Plus__WPdx__.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">#clean_country_name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Nigeria"</span> <span class="sc">&amp;</span>  <span class="st">`</span><span class="at">#clean_adm1</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Osun"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="converting-water-point-data-into-sf-point-features" class="level3">
<h3 class="anchored" data-anchor-id="converting-water-point-data-into-sf-point-features">4.1.1 - Converting water point data into <em>sf</em> point features</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>wp_nga<span class="sc">$</span>Geometry <span class="ot">=</span> <span class="fu">st_as_sfc</span>(wp_nga<span class="sc">$</span><span class="st">`</span><span class="at">New Georeferenced Column</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>wp_sf <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(wp_nga, <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>wp_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5557 features and 70 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 4.032004 ymin: 7.060309 xmax: 5.06 ymax: 8.061898
Geodetic CRS:  WGS 84
# A tibble: 5,557 × 71
   row_id `#source`      #lat_…¹ #lon_…² #repo…³ #stat…⁴ #wate…⁵ #wate…⁶ #wate…⁷
 *  &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
 1 429123 GRID3             8.02    5.06 08/29/… Unknown &lt;NA&gt;    &lt;NA&gt;    Tapsta…
 2  70566 Federal Minis…    7.32    4.79 05/11/… No      Protec… Well    Mechan…
 3  70578 Federal Minis…    7.76    4.56 05/11/… No      Boreho… Well    Mechan…
 4  66401 Federal Minis…    8.03    4.64 04/30/… No      Boreho… Well    Mechan…
 5 422190 GRID3             7.87    4.88 08/29/… Unknown &lt;NA&gt;    &lt;NA&gt;    Tapsta…
 6 422064 GRID3             7.7     4.89 08/29/… Unknown &lt;NA&gt;    &lt;NA&gt;    Tapsta…
 7  65607 Federal Minis…    7.89    4.71 05/12/… No      Boreho… Well    Mechan…
 8  68989 Federal Minis…    7.51    4.27 05/07/… No      Boreho… Well    &lt;NA&gt;   
 9  67708 Federal Minis…    7.48    4.35 04/29/… Yes     Boreho… Well    Mechan…
10  66419 Federal Minis…    7.63    4.50 05/08/… Yes     Boreho… Well    Hand P…
# … with 5,547 more rows, 62 more variables: `#water_tech_category` &lt;chr&gt;,
#   `#facility_type` &lt;chr&gt;, `#clean_country_name` &lt;chr&gt;, `#clean_adm1` &lt;chr&gt;,
#   `#clean_adm2` &lt;chr&gt;, `#clean_adm3` &lt;chr&gt;, `#clean_adm4` &lt;chr&gt;,
#   `#install_year` &lt;dbl&gt;, `#installer` &lt;chr&gt;, `#rehab_year` &lt;lgl&gt;,
#   `#rehabilitator` &lt;lgl&gt;, `#management_clean` &lt;chr&gt;, `#status_clean` &lt;chr&gt;,
#   `#pay` &lt;chr&gt;, `#fecal_coliform_presence` &lt;chr&gt;,
#   `#fecal_coliform_value` &lt;dbl&gt;, `#subjective_quality` &lt;chr&gt;, …</code></pre>
</div>
</div>
</section>
<section id="transforming-into-nigeria-projected-coordinate-system" class="level3">
<h3 class="anchored" data-anchor-id="transforming-into-nigeria-projected-coordinate-system">4.1.2 - Transforming into Nigeria projected coordinate system</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>wp_sf <span class="ot">&lt;-</span> wp_sf <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">26391</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="importing-geospatial-data-shp-format" class="level2">
<h2 class="anchored" data-anchor-id="importing-geospatial-data-shp-format">4.2 - Importing Geospatial Data, <em>shp</em> format</h2>
<section id="the-nga-data-set" class="level3">
<h3 class="anchored" data-anchor-id="the-nga-data-set">4.2.1 - The NGA data set</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>nga <span class="ot">=</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer =</span> <span class="st">"nga_admbnda_adm2"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ADM1_EN <span class="sc">==</span> <span class="st">"Osun"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `nga_admbnda_adm2' from data source 
  `C:\p-haas\IS415\Take-home_Ex\data\geospatial' using driver `ESRI Shapefile'
Simple feature collection with 774 features and 16 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 2.668534 ymin: 4.273007 xmax: 14.67882 ymax: 13.89442
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(nga)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["latitude",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["longitude",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>nga <span class="ot">&lt;-</span> nga <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">26391</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-geoboundaries-data-set" class="level3">
<h3 class="anchored" data-anchor-id="the-geoboundaries-data-set">4.2.2 - The geoBoundaries data set</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>geoNGA <span class="ot">=</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">layer =</span> <span class="st">"geoBoundaries-NGA-ADM2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `geoBoundaries-NGA-ADM2' from data source 
  `C:\p-haas\IS415\Take-home_Ex\data\geospatial' using driver `ESRI Shapefile'
Simple feature collection with 774 features and 5 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 2.668534 ymin: 4.273007 xmax: 14.67882 ymax: 13.89442
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(geoNGA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    ENSEMBLE["World Geodetic System 1984 ensemble",
        MEMBER["World Geodetic System 1984 (Transit)"],
        MEMBER["World Geodetic System 1984 (G730)"],
        MEMBER["World Geodetic System 1984 (G873)"],
        MEMBER["World Geodetic System 1984 (G1150)"],
        MEMBER["World Geodetic System 1984 (G1674)"],
        MEMBER["World Geodetic System 1984 (G1762)"],
        MEMBER["World Geodetic System 1984 (G2139)"],
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]],
        ENSEMBLEACCURACY[2.0]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["geodetic latitude (Lat)",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["geodetic longitude (Lon)",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    USAGE[
        SCOPE["Horizontal component of 3D system."],
        AREA["World."],
        BBOX[-90,-180,90,180]],
    ID["EPSG",4326]]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>geoNGA <span class="ot">&lt;-</span> geoNGA <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">26391</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="data-cleaning-wrangling" class="level1">
<h1>5 - Data Cleaning &amp; Wrangling</h1>
<section id="geospatial-data-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="geospatial-data-cleaning">5.1 - Geospatial Data Cleaning</h2>
<section id="excluding-redundant-fields" class="level3">
<h3 class="anchored" data-anchor-id="excluding-redundant-fields">5.1.1 - Excluding redundant fields</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>nga <span class="ot">&lt;-</span> nga <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">8</span><span class="sc">:</span><span class="dv">9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="checking-for-duplicated-name" class="level3">
<h3 class="anchored" data-anchor-id="checking-for-duplicated-name">5.1.2 - Checking for duplicated name</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>nga<span class="sc">$</span>ADM2_EN[<span class="fu">duplicated</span>(nga<span class="sc">$</span>ADM2_EN)<span class="sc">==</span><span class="cn">TRUE</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>character(0)</code></pre>
</div>
</div>
</section>
</section>
<section id="data-wrangling-for-water-point-data" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling-for-water-point-data">5.2 - Data Wrangling for Water Point Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>funModeling<span class="sc">::</span><span class="fu">freq</span>(<span class="at">data =</span> wp_sf,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">input =</span> <span class="st">'#status_clean'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                     #status_clean frequency percentage cumulative_perc
1                       Functional      2319      41.73           41.73
2                   Non-Functional      2008      36.13           77.86
3                             &lt;NA&gt;       748      13.46           91.32
4      Functional but needs repair       248       4.46           95.78
5 Non-Functional due to dry season       151       2.72           98.50
6        Functional but not in use        63       1.13           99.63
7                        Abandoned        15       0.27           99.90
8         Abandoned/Decommissioned         5       0.09          100.00</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>wp_sf_nga <span class="ot">&lt;-</span> wp_sf <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">status_clean =</span> <span class="st">'#status_clean'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(status_clean) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">status_clean =</span> <span class="fu">replace_na</span>(</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    status_clean, <span class="st">"unknown"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="extracting-water-point-data" class="level3">
<h3 class="anchored" data-anchor-id="extracting-water-point-data">5.2.1 - Extracting water point data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>wp_sf_functional <span class="ot">&lt;-</span> wp_sf_nga <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">%in%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">"Functional"</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Functional but not in use"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Functional but needs repair"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>wp_sf_nonfunctional <span class="ot">&lt;-</span> wp_sf_nga <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">%in%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">"Abandoned/Decommissioned"</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Abandoned"</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Non-Functional due to dry season"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Non-Functional"</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Non functional due to dry season"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>wp_sf_unknown <span class="ot">&lt;-</span> wp_sf_nga <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(status_clean <span class="sc">==</span> <span class="st">"unknown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="performing-point-in-polygon-count" class="level3">
<h3 class="anchored" data-anchor-id="performing-point-in-polygon-count">5.2.2 - Performing Point-in-Polygon Count</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>nga_wp <span class="ot">&lt;-</span> nga <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">total_wp</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">lengths</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_intersects</span>(nga, wp_sf_nga))) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">wp_functional</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">lengths</span>(</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_intersects</span>(nga, wp_sf_functional))) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">wp_nonfunctional</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">lengths</span>(</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_intersects</span>(nga, wp_sf_nonfunctional))) <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">wp_unknown</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">lengths</span>(</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_intersects</span>(nga, wp_sf_unknown)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="converting-sf-data-frames-to-sps-spatial-class" class="level2">
<h2 class="anchored" data-anchor-id="converting-sf-data-frames-to-sps-spatial-class">5.3 - Converting <em>sf</em> data frames to <em>sp’s</em> Spatial* class</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>wp_functional <span class="ot">=</span> <span class="fu">as_Spatial</span>(wp_sf_functional)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>wp_nonfunctional <span class="ot">=</span> <span class="fu">as_Spatial</span>(wp_sf_nonfunctional)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>nga_spat <span class="ot">=</span> <span class="fu">as_Spatial</span>(nga)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>wp_functional</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPointsDataFrame 
features    : 2630 
extent      : 179198.9, 291989.5, 341443.2, 449013.7  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=4 +lon_0=4.5 +k=0.99975 +x_0=230738.26 +y_0=0 +a=6378249.145 +rf=293.465 +towgs84=-92,-93,122,0,0,0,0 +units=m +no_defs 
variables   : 1
names       :              status_clean 
min values  :                Functional 
max values  : Functional but not in use </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>wp_nonfunctional</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPointsDataFrame 
features    : 2179 
extent      : 182490.7, 291855.5, 338261.8, 448933.5  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=4 +lon_0=4.5 +k=0.99975 +x_0=230738.26 +y_0=0 +a=6378249.145 +rf=293.465 +towgs84=-92,-93,122,0,0,0,0 +units=m +no_defs 
variables   : 1
names       :                     status_clean 
min values  :                        Abandoned 
max values  : Non-Functional due to dry season </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>nga_spat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPolygonsDataFrame 
features    : 30 
extent      : 178398.7, 292278.9, 329463.4, 452734.9  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=4 +lon_0=4.5 +k=0.99975 +x_0=230738.26 +y_0=0 +a=6378249.145 +rf=293.465 +towgs84=-92,-93,122,0,0,0,0 +units=m +no_defs 
variables   : 4
names       :  ADM2_EN, ADM2_PCODE, ADM1_EN, ADM1_PCODE 
min values  : Aiyedade,   NG030001,    Osun,      NG030 
max values  :   Osogbo,   NG030030,    Osun,      NG030 </code></pre>
</div>
</div>
</section>
<section id="converting-the-spatial-class-into-generic-sp-format" class="level2">
<h2 class="anchored" data-anchor-id="converting-the-spatial-class-into-generic-sp-format">5.4 - Converting the Spatial* class into generic <em>sp</em> format</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>wp_functional_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_functional, <span class="st">"SpatialPoints"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>wp_nonfunctional_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_nonfunctional, <span class="st">"SpatialPoints"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>nga_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(nga_spat, <span class="st">"SpatialPolygons"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="converting-the-generic-sp-format-into-spatstats-ppp-format" class="level2">
<h2 class="anchored" data-anchor-id="converting-the-generic-sp-format-into-spatstats-ppp-format">5.5 - Converting the generic <em>sp</em> format into <em>spatstat’s</em> ppp format</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>wp_functional_ppp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_functional_sp, <span class="st">"ppp"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>wp_nonfunctional_ppp <span class="ot">&lt;-</span> <span class="fu">as</span>(wp_nonfunctional_sp, <span class="st">"ppp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>wp_functional_ppp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Planar point pattern: 2630 points
window: rectangle = [179198.89, 291989.51] x [341443.2, 449013.7] units</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wp_functional_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wp_functional_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Planar point pattern:  2630 points
Average intensity 2.167651e-07 points per square unit

Coordinates are given to 2 decimal places
i.e. rounded to the nearest multiple of 0.01 units

Window: rectangle = [179198.89, 291989.51] x [341443.2, 449013.7] units
                    (112800 x 107600 units)
Window area = 12132900000 square units</code></pre>
</div>
</div>
</section>
<section id="creating-owin-object" class="level2">
<h2 class="anchored" data-anchor-id="creating-owin-object">5.6 - Creating <em>owin</em> object</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>nga_owin <span class="ot">&lt;-</span> <span class="fu">as</span>(nga_sp, <span class="st">"owin"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nga_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="combining-point-events-object-and-owin-object" class="level2">
<h2 class="anchored" data-anchor-id="combining-point-events-object-and-owin-object">5.7 Combining point events object and <em>owin</em> object</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>wp_functional_ppp <span class="ot">=</span> wp_functional_ppp[nga_owin]</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>wp_nonfunctional_ppp <span class="ot">=</span> wp_nonfunctional_ppp[nga_owin]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wp_functional_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="exploratory-spatial-data-analysis" class="level1 page-columns page-full">
<h1>6 - Exploratory Spatial Data Analysis</h1>
<p>This section has for objective:</p>
<ul>
<li><p>Deriving kernel density maps of functional and non-functional water points</p></li>
<li><p>Display kernel density maps of the <u>Osun State, Nigeria</u> on <strong><em>openstreetmap</em></strong> using appropriate <strong><em>tmap</em></strong> functions</p></li>
<li><p>Describe the spatial patterns revealed by the kernel density maps &amp; highlight the advantage of kernel density map over point map</p></li>
</ul>
<section id="kernel-density-estimation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="kernel-density-estimation">6.1 - Kernel Density Estimation</h2>
<p>Our first step to KDE is to derive two density maps for functional and non-functional water points to check for any potential data problem. Here, we suspect that the scale of density values will be expressed in meters. The default measurement unit of Nigeria’s projected coordinate system – <a href="https://epsg.io/26391">EPSG:26391</a> – is expressed in meters. We shall verify that and correct it to kilometers to get a more desirable map output (scale).</p>
<p>For starters, we should use the <em>density()</em> function to compute kernel density estimates for both types of water points. We use <em>bw.ppl</em> method for smoothing the bandwidth for the kernel estimation point process intensity and leave the default kernel smoothing method – it is the Gaussian method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>kde_wpfunc <span class="ot">&lt;-</span> <span class="fu">density</span>(wp_functional_ppp, </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">sigma=</span>bw.ppl, </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">edge=</span><span class="cn">TRUE</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>kde_wpnonfunc <span class="ot">&lt;-</span> <span class="fu">density</span>(wp_nonfunctional_ppp,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sigma=</span>bw.ppl,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">edge=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpfunc, </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Functional Water Points"</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ribside=</span><span class="fu">c</span>(<span class="st">"bottom"</span>))</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpnonfunc,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Non-Functional Water Points"</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ribside=</span><span class="fu">c</span>(<span class="st">"bottom"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The density values of the output range from 0 to 0.000006 and it makes for an output difficult to comprehend and interpret. Thus, we will rescale our density values to get an output in “number of points per square kilometer”.</p>
<section id="rescalling-kde-values" class="level3">
<h3 class="anchored" data-anchor-id="rescalling-kde-values">6.1.1 - Rescalling KDE values</h3>
<p>To change the scale of the density values, we use the <em>rescale()</em> function from the <strong><em>spatstat.geom</em></strong> package. Here, we multiply values of our two objects of class <em>ppp</em> by 1000. We thus express them in kilometers and define the unit name to be “km”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>wp_functional_ppp.km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(wp_functional_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>wp_nonfunctional_ppp.km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(wp_nonfunctional_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now run the previously used <em>density()</em> function using the rescaled data and plot the output KDE map.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>kde_wpfunc.km <span class="ot">&lt;-</span> <span class="fu">density</span>(wp_functional_ppp.km, </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">sigma=</span>bw.ppl, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">edge=</span><span class="cn">TRUE</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>kde_wpnonfunc.km <span class="ot">&lt;-</span> <span class="fu">density</span>(wp_nonfunctional_ppp.km,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sigma=</span>bw.ppl,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">edge=</span><span class="cn">TRUE</span>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpfunc.km, </span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Functional Water Points"</span>,</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ribside=</span><span class="fu">c</span>(<span class="st">"bottom"</span>))</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(kde_wpnonfunc.km,</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Non-Functional Water Points"</span>,</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">ribside=</span><span class="fu">c</span>(<span class="st">"bottom"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex1_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We start observing signs of potential clustering but, for now, we shall focus on transforming our <em>im</em> objects into <em>rasters</em> to plot our KDE maps using the <strong><em>tmap</em></strong> package. We will talk more about CSR and clustering later.</p>
</section>
<section id="convert-kde-output-into-grid-object" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="convert-kde-output-into-grid-object">6.1.2 - Convert KDE output into grid object</h3>
<div class="page-columns page-full">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>gridded_wpfunc <span class="ot">&lt;-</span> <span class="fu">as.SpatialGridDataFrame.im</span>(kde_wpfunc.km)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>gridded_wpnonfunc <span class="ot">&lt;-</span> <span class="fu">as.SpatialGridDataFrame.im</span>(kde_wpnonfunc.km)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">spplot</span>(gridded_wpfunc)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spplot</span>(gridded_wpnonfunc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-KDEgridded" class="cell column-page quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-KDEgridded-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/fig-KDEgridded-1.png" class="img-fluid figure-img" data-ref-parent="fig-KDEgridded" width="672"></p>
<p></p><figcaption class="figure-caption">(a) Functional Water Points</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-KDEgridded-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Take-home_Ex1_files/figure-html/fig-KDEgridded-2.png" class="img-fluid figure-img" data-ref-parent="fig-KDEgridded" width="672"></p>
<p></p><figcaption class="figure-caption">(b) Non-Functional Water Points</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: <strong>?(caption)</strong></figcaption><p></p>
</figure>
</div>
</div>
</section>
<section id="converting-grid-object-into-raster" class="level3">
<h3 class="anchored" data-anchor-id="converting-grid-object-into-raster">6.1.3 - Converting grid object into raster</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>kde_wpfunc_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(gridded_wpfunc)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>kde_wpfunc_raster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 0.8896887, 0.9630582  (x, y)
extent     : 178.3987, 292.2789, 329.4634, 452.7349  (xmin, xmax, ymin, ymax)
crs        : NA 
source     : memory
names      : v 
values     : -3.514656e-16, 11.15238  (min, max)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>kde_wpnonfunc_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(gridded_wpnonfunc)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>kde_wpnonfunc_raster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 0.8896887, 0.9630582  (x, y)
extent     : 178.3987, 292.2789, 329.4634, 452.7349  (xmin, xmax, ymin, ymax)
crs        : NA 
source     : memory
names      : v 
values     : -3.628555e-16, 10.26005  (min, max)</code></pre>
</div>
</div>
</section>
<section id="assigning-projection-systems" class="level3">
<h3 class="anchored" data-anchor-id="assigning-projection-systems">6.1.4 - Assigning projection systems</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(kde_wpfunc_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:26391 +datum:WGS84 +units=km"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>kde_wpfunc_raster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 0.8896887, 0.9630582  (x, y)
extent     : 178.3987, 292.2789, 329.4634, 452.7349  (xmin, xmax, ymin, ymax)
crs        : +init=EPSG:26391 +datum:WGS84 +units=km 
source     : memory
names      : v 
values     : -3.514656e-16, 11.15238  (min, max)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(kde_wpnonfunc_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:26391 +datum:WGS84 +units=km"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>kde_wpnonfunc_raster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class      : RasterLayer 
dimensions : 128, 128, 16384  (nrow, ncol, ncell)
resolution : 0.8896887, 0.9630582  (x, y)
extent     : 178.3987, 292.2789, 329.4634, 452.7349  (xmin, xmax, ymin, ymax)
crs        : +init=EPSG:26391 +datum:WGS84 +units=km 
source     : memory
names      : v 
values     : -3.628555e-16, 10.26005  (min, max)</code></pre>
</div>
</div>
</section>
</section>
<section id="visualizing-kde-with-tmap" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-kde-with-tmap">6.2 - Visualizing KDE with tmap</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'view'</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_basemap</span>(<span class="st">"OpenStreetMap"</span>) <span class="sc">+</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kde_wpfunc_raster) <span class="sc">+</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-a33f01eb1e110927fa5f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a33f01eb1e110927fa5f">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHsAAACGCAYAAAD9y/W4AAAFr0lEQVR4nO2dv2okRxDGa8SFMg5O4GAdGI7F0UZ+ASvwC1zm1IFfzZlf4AJdfHCRnJjBoGQODNpAx4SGcSBaGo3mT/+p7qnq+n4gWEnszHR//VV3dff2NgTEMAw3g3vdNNcN9/XZLwjiGYs9hUN8iL2Aq/gcDtu65xopzwOxJ0wrPKVy58Rbup6P0DHPNG60EJu2K3pNIPe/ELHG1wx939YzjZ/t1XtiblQLsQL5vrfr26fXh8tj0LPFPJNj6dlMi00U7ywpTMVeKk/Xt/SmzCOBWFx02IoMPo0WYgunfbgjonWxfYT+/pvfmwu2pwLsjPv8JULSNThbMByDunGfbnqApn1w5sNYbIRxQ0BsQ0BsQ+zSZ++xyDB3/9qZ1u/uKzrSVpVqYa5edwvjLofMLcAw3AzuJ+d9tvDJmblYMlARsacVPS14LjFKC9z17ayoEoQmKhTGc63Vhl47J75z2DnZqrvsYocsBR4uj1F9uBTB98Sn3rJMl4ZUfte31D7c0e39md6/e7khQBol1qdDCakr9j47xmW392f66/wftQ931PVt0qaCUiz1z7nf62ia6ya03FVMqpQK43NujhHucHlMigyxjVvEqtf7dz/R6eoxlB+//YGI5sN57n3VPuwdvsXtLo1x2tJoNnVjXk2kNvCs7uAQqGmuGwj9SKrYrGFciigScl5uxHwiRIrIDokpUgpc45NNZ6dshJdA17dVCM7BaurlxJWwkBCK25UJnqkiz57DpXDgmUWxtTl5zDhsI4Q/I2JSJQcQ+TXVhnHwGtNicyxIaMK02NYwKbZztEvPONytIUpUO0Bbwgny5z+fn/7GkaZpGBCadPZ0wkWDUByYczbRSydbmnyZFVvThEroCpcVF8+RfEzTnnzsPtAff/9LRES//vgd/Xz4Zecn4odzR85sny11d+eYrm/p9v5Mn758pU9fvtLt/Vn8aHhv1PbZh8sjna7u6LfT4++nq7emQ7QPiw7WEspr26gwhjvCFnV2jo0EtQmcE+/T8UB5uJ3tdToeKE+OQfIbIohsBZPTpVa5gKvtoHaLcM3kmtS6cBdPuUHXt/Sx+xA8g6VhDTgGqeV6kWfHfK6q69sXa8NEYblvbXmy2xQhcTXt1QAtxuGnq7dPr0M+w1yr0OPfQ8m5LjE7gxbicCeYxJa8N9Ia82YrCj0fRVoBSzJ18h6nK6yhdtVLIpwNPcdBQphUMYRXy5m2MuTl5ci+UyXnDcF+BPXZcLRuvPtsCK0fnBMqHM4uNOpCELwsXIKrSr2kLjBoIVrsPUboqWd+LiG9AXFF0iixndBIyXShKoznwsp8PsRWAkcor1rstb7YDfak99ecVC32Unh2Ams7BTHV3Uli58y3c7tOm9AcmF3P1rqzJmWdOyl1wkzaPsSKHR3GIbQ+qh6g1Uqs0bAQopyQkA6xK8FHdIRxQ8DZFbLr92cDGUBsQ0BsQ0TPoKHflsnaqJxtbrzGr0QszZxQvqbySb1YnM356UUL7LWdiy2MW/+47hYS9uuhzy6ABKGJMBrPjhShiSC2KSC2ITA3nglJ4dsBZxsCYhsCYhsCYmdAYn9NBLFNgWM2MiHR3XC2IbyXOOFo/cDZhvASG66uA9YjqMEjEgdnRAjjplhtgXB1OFJdTQRnm8LsyQvcSHa0A2Inoum0pcUwjv66PhZDT8jmdOsNQ0MIJ0oI41oKmAOtZQ9OvZYKasndWsVedPZUPK0FBM+wCWjF2ZobPSZVAtAsNBHybC+0i+xgLUSNobwWoYkQxlepSWiiHcM4vtuzPMXD+JpbJIlem6uJCofxrQqssYIlwV65S+6MEXJPp9fY8LL32SmV5t4rKbxrhj2Mj8Wt0R2ayeJsiCwTNaKUCOW1N1IVheMSunYxtzAzg2ZdaKIKxG6a6wb5ux/qxQb+qGnxvluksMOmEobhZsAESzz/AxTi2QnODnYjAAAAAElFTkSuQmCC",[[8.09504026647569,4.02502086977746],[6.9768697144782,5.06036064191272]],1,null,"tmap401","kde_wpfunc_raster"]},{"method":"addLegend","args":[{"colors":["#FFFFBF","#E4F39A","#BFE47A","#92D067","#66BD63","#30A355"],"labels":["0 to 2","2 to 4","4 to 6","6 to 8","8 to 10","10 to 12"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"unknown","title":"v","extra":null,"layerId":"legend401","className":"info legend kde_wpfunc_raster","group":"kde_wpfunc_raster"}]},{"method":"addLayersControl","args":[[],"kde_wpfunc_raster",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[6.9768697144782,8.09504026647569],"lng":[4.02502086977746,5.06036064191272]},"fitBounds":[6.97997286813081,4.02502086977746,8.09504026647569,5.05847621601094,[]]},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'view'</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_basemap</span>(<span class="st">"OpenStreetMap"</span>) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kde_wpnonfunc_raster) <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="st">"v"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e1f31811b642f092f68e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-e1f31811b642f092f68e">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHsAAACGCAYAAAD9y/W4AAAFHElEQVR4nO2duU4cQRCG/0GESAQ4IyFZkdgPwWPwhH4McqeOrE1I1pIlO8AiHwdWw+wwR99d1fV/EYd2jv6mqs/tGUDEMI5Po/t5GB6G3MfPfkASz1T2nBzyKXsFV/AlImzvnFukXA9lz5gXeErhLslbO56P6Jhrmj60lI39gt4S5P4XImt6zNDP7V3T9No+fCbmRL0QKyjms6VYkr52baZlA3KkxTKXvXU/F+Uvpz9Or8fWl/CBcXwa9x5cyg7Eia4l/PR63D2XbyuesiO5vTq0vgQAYd011tkK6uzT6zH64ZrW6aZlaxCdylQ207ghKNsQlG2IJnV2i0mGpfP3zrx8m8/oSJtV6oWlchVR0CWFWxLsWCvPKrJ9Czy39Nqi3UhXywGXrTIUJRsIFy4lcqWLBirITplGLHWOFCRIXcKn3C5LnDim8N2Q4HRBgDROr0ccX57ffpcgPKSsshdqrGiHK0CJ6XwuGwAO13cA6ouPCYgikV2bWml8LvT48vwmv6bs2MwnYgRtqaCWBLoJ+paNsturw9v1uqiuibjVpTllpC7MK03K9GMoqW2Zog2hHIKG4WGQKro2qbKz1tlSpCw1+LSTo4eSpc4uWY/GHnfeatZMrq7obmSnLIRvTYuWsmQ2I9vJbd0CjqFFS1k6IrpeuWnZNZLMqmxtkTzHCWcKf6fLyHZQ9DldyybnULYhKNsQXcx6hdLjCJsPJmUDELcIoQZmZQPA999/3n62INysbDfgcri+MyEaWJGtfUBlj6lcK6KBlflsLbItNLRyLr5c7HpJXd25RE9TmaVRXWf3Gs2lWI1gLam8Z3JnWI6gGeJDGmdE94v37nikLiUayZcAJVuBdbYhLhjVdlC5RLh3Sg1qXbiDp55A4k69LfDZWLYVZ3V2rPDaO/VKZXr/EsviQwNN07i4RKbf2Y6hZPkvjo2HfnNyb4xa6j4k1th9ith48yfnlGuTl7hRdjs4EUKi8Xpy5ttVMdrrUXylSskTakFyfzkWcXuNkXOqRzZA0T0gep9Q0iiyS5w8ht7q0T1yBpeqrhfH4NOIlt0ywq0Nu+aK7mRhrMPrIGbTO6IDs7K1DZrkyKCqv/4Ti8Q3AtTAnGwn+uuPXwCAx/v/f9cgPPWVGklpvGTjrEaa/fbz79nuC71jLrJdBD/eA59vLvHl003jKwojJbqTmvNau13zjBGawlsvs6ouW6voHlD9QhgSRmygRT0hjGo5FH+JG2XLw0c607ghGNkdshbljGxDULYhKNsQHFTpjK1Wedax8dbDiNpZEuUbVD5dr2yyNS0EaE3QQEjGtX5ZZFvYHTiV1kuwATbQqiBBNJBJNt+Ot44U0UDGyKZo+TCNG4Jj44WQlL4djGxDULYhKNsQlF0AifU1QNmm4DYbhZAY3YxsQ3hPhDCi9cPINoSXbEZ1H3BX4gJIbJwBTOOm2HwCGdXhSI1qgJFtCnM7L5RCckQ7GNmGWJXN+ro/kiNbQ/oqjZYyiK6ztdxgCbTee3DXa+1GLaV9rbJXI3suT+sNkneyCbQS2Zofena9AtAsGuCgihfaJTuy3kSPqbwX0QDT+CY9iQYapnG+27M+1dP4VrRIkt5bVAOV0/heAfZYwJLIXrhr0RkjsmWk9/jgFa+zUwrNfVZSetdM9jQ+ldtjdGimSGRTskzUSKmRynt/SFXcXLYXj3Yucw8zI2jWRQMdyB6Gh4H9dz/Uyyb+qHnifZdIcYVNJ4zj08gBlnj+AX8kdo9SE1BrAAAAAElFTkSuQmCC",[[8.09504026647569,4.02502086977746],[6.9768697144782,5.06036064191272]],1,null,"tmap401","kde_wpnonfunc_raster"]},{"method":"addLegend","args":[{"colors":["#FFFFBF","#E4F39A","#BFE47A","#92D067","#66BD63","#30A355"],"labels":["0 to 2","2 to 4","4 to 6","6 to 8","8 to 10","10 to 12"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"unknown","title":"v","extra":null,"layerId":"legend401","className":"info legend kde_wpnonfunc_raster","group":"kde_wpnonfunc_raster"}]},{"method":"addLayersControl","args":[[],"kde_wpnonfunc_raster",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[6.9768697144782,8.09504026647569],"lng":[4.02502086977746,5.06036064191272]},"fitBounds":[6.97997286813081,4.02502086977746,8.09504026647569,5.05847621601094,[]]},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="nearest-neighbor-index" class="level2">
<h2 class="anchored" data-anchor-id="nearest-neighbor-index">6.3 - Nearest Neighbor Index</h2>
<p>Before moving on to the Second-order Spatial Points Analysis, I would like to perform the Clark-Evans test to measure aggregation of functional and non-functional water points. The goal is to test the randomness of the data points and assess whether they are randomly distributed, clustered or dispersed.</p>
<p>We will perform a series of 2 tests, first on functional water points and, second, on non-functional water points. We will be using the <em>clarkevans.test()</em> function of the <strong>spatstat</strong> package.</p>
<p>The hypotheses are the following:</p>
<p><strong><em>Test 1</em></strong></p>
<p><strong>H<sub>0</sub> :</strong> Functional Water Points are randomly distributed</p>
<p><strong>H<sub>1</sub> :</strong> Functional Water Points are not randomly distributed, they are clustered</p>
<p><strong><em>Test 2</em></strong></p>
<p><strong>H<sub>0</sub> :</strong> Non-functional Water Points are randomly distributed</p>
<p><strong>H<sub>1</sub> :</strong> Non-functional Water Points are not randomly distributed, they are clustered</p>
<p>As you may have read above, we determine the alternative hypothesis to be that water points are clustered. This decision is based on an intuition that derives from the previously seen visual representations of functional and non-functional water points. Indeed, we observed in our KDE plots some concentration of data points across the Osun State. Thus, we would like to test for clustering directly to prove this intuition.</p>
<p>Please note that when conducting our tests, we will use a 5% significance level.</p>
<section id="test-1-on-functional-water-points" class="level3">
<h3 class="anchored" data-anchor-id="test-1-on-functional-water-points">6.3.1 - Test 1 on functional water points</h3>
<p>First test on functional water points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clarkevans.test</span>(wp_functional_ppp,</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">correction=</span><span class="st">"none"</span>,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">clipregion=</span><span class="cn">NULL</span>,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">alternative=</span><span class="fu">c</span>(<span class="st">"clustered"</span>),</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Clark-Evans test
    No edge correction
    Monte Carlo test based on 99 simulations of CSR with fixed n

data:  wp_functional_ppp
R = 0.44265, p-value = 0.01
alternative hypothesis: clustered (R &lt; 1)</code></pre>
</div>
</div>
</section>
<section id="test-2-on-non-functional-water-points" class="level3">
<h3 class="anchored" data-anchor-id="test-2-on-non-functional-water-points">6.3.2 - Test 2 on non-functional water points</h3>
<p>Second test on non-functional water points</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clarkevans.test</span>(wp_nonfunctional_ppp,</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">correction=</span><span class="st">"none"</span>,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">clipregion=</span><span class="cn">NULL</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">alternative=</span><span class="fu">c</span>(<span class="st">"clustered"</span>),</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Clark-Evans test
    No edge correction
    Monte Carlo test based on 99 simulations of CSR with fixed n

data:  wp_nonfunctional_ppp
R = 0.43223, p-value = 0.01
alternative hypothesis: clustered (R &lt; 1)</code></pre>
</div>
</div>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">6.3.3 - Conclusion</h3>
<p>Conclusion?</p>
</section>
</section>
</section>
<section id="second-order-spatial-point-patterns-analysis" class="level1">
<h1>7 - Second-order Spatial Point Patterns Analysis</h1>
<section id="formulate-the-null-hypothesis-and-alternative-hypothesis-and-select-the-confidence-level" class="level2">
<h2 class="anchored" data-anchor-id="formulate-the-null-hypothesis-and-alternative-hypothesis-and-select-the-confidence-level">7.1 - Formulate the null hypothesis and alternative hypothesis and select the confidence level</h2>
</section>
<section id="perform-the-test-by-using-appropriate-second-order-spatial-point-patterns-analysis-technique" class="level2">
<h2 class="anchored" data-anchor-id="perform-the-test-by-using-appropriate-second-order-spatial-point-patterns-analysis-technique">7.2 - Perform the test by using appropriate Second order spatial point patterns analysis technique</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># G_tm = Gest(wp_functional_ppp, correction = "best")</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(G_tm)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="with-reference-to-the-analysis-results-draw-statistical-conclusions" class="level2">
<h2 class="anchored" data-anchor-id="with-reference-to-the-analysis-results-draw-statistical-conclusions">7.3 - With reference to the analysis results, draw statistical conclusions</h2>
</section>
</section>
<section id="spatial-correlation-analysis" class="level1">
<h1>8 - Spatial Correlation Analysis</h1>
<p>In this section, you are required to confirm statistically if the spatial distribution of functional and non-functional water points are independent from each other.</p>
<section id="formulate-the-null-hypothesis-and-alternative-hypothesis-and-select-the-confidence-level-1" class="level2">
<h2 class="anchored" data-anchor-id="formulate-the-null-hypothesis-and-alternative-hypothesis-and-select-the-confidence-level-1">8.1 - Formulate the null hypothesis and alternative hypothesis and select the confidence level</h2>
</section>
<section id="perform-the-test-by-using-appropriate-second-order-spatial-point-patterns-analysis-technique-1" class="level2">
<h2 class="anchored" data-anchor-id="perform-the-test-by-using-appropriate-second-order-spatial-point-patterns-analysis-technique-1">8.2 - Perform the test by using appropriate Second order spatial point patterns analysis technique</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#L_wpfunc = Lest(wp_functional_ppp, correction = "Ripley")</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(L_wpfunc, . -r ~ r, ylab= "L(d)-r", xlab = "d(m)")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># L_wp1.csr &lt;- envelope(wp1_ppp, Lest, nsim = 99, rank = 1, glocal=TRUE)</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(L_wp1.csr, . - r ~ r, xlab="d", ylab="L(d)-r", main = "L-test for Functional WP in Borepe")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># K_wpnonfunc = Kest(wp_nonfunctional_ppp, correction = "isotropic")</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(K_wpnonfunc, . -r ~ r, ylab= "K(d)-r", xlab = "d(m)", xlim=c(0,1000))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="with-reference-to-the-analysis-results-draw-statistical-conclusions-1" class="level2">
<h2 class="anchored" data-anchor-id="with-reference-to-the-analysis-results-draw-statistical-conclusions-1">8.3 - With reference to the analysis results, draw statistical conclusions</h2>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>