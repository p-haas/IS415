{
  "hash": "b59d547b4bfd11337c91b036c9892c23",
  "result": {
    "markdown": "---\ntitle: \"In-Class Exercise - \"\n\nauthor: \"Pierre HAAS\"\n\ndate: \"February 13, 2023\"\ndate-modified: \"2023-03-19\"\n\nexecute:\n  eval: true\n  echo: true\n  warning: false\neditor: visual\n\nnumber-sections: true\n---\n\n\n# Getting Started\n\n## Installing and Loading Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf, sfdep, tmap, tidyverse)\n```\n:::\n\n\n## Import data sets\n\n### Aspatial data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhunan2012 = read_csv(\"data/aspatial/Hunan_2012.csv\")\nhead(hunan2012)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 29\n  County   City  avg_w…¹ depos…²   FAI Gov_Rev Gov_Exp    GDP GDPPC    GIO  Loan\n  <chr>    <chr>   <dbl>   <dbl> <dbl>   <dbl>   <dbl>  <dbl> <dbl>  <dbl> <dbl>\n1 Anhua    Yiya…   30544  10967  6832.    457.   2703  13225  14567  9277. 3955.\n2 Anren    Chen…   28058   4599. 6386.    221.   1455.  4941. 12761  4189. 2555.\n3 Anxiang  Chan…   31935   5517. 3541     244.   1780. 12482  23667  5109. 2807.\n4 Baojing  Huna…   30843   2250  1005.    193.   1379.  4088. 14563  3624. 1254.\n5 Chaling  Zhuz…   31251   8241. 6508.    620.   1947  11585  20078  9158. 4287.\n6 Changni… Heng…   28518  10860  7920     770.   2632. 19886  24418 37392  4243.\n# … with 18 more variables: NIPCR <dbl>, Bed <dbl>, Emp <dbl>, EmpR <dbl>,\n#   EmpRT <dbl>, Pri_Stu <dbl>, Sec_Stu <dbl>, Household <dbl>,\n#   Household_R <dbl>, NOIP <dbl>, Pop_R <dbl>, RSCG <dbl>, Pop_T <dbl>,\n#   Agri <dbl>, Service <dbl>, Disp_Inc <dbl>, RORP <dbl>, ROREmp <dbl>, and\n#   abbreviated variable names ¹​avg_wage, ²​deposite\n```\n:::\n:::\n\n\n### Geospatial data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhunanGeo = st_read(dsn = \"data/geospatial\",\n                   layer = \"Hunan\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `Hunan' from data source \n  `C:\\p-haas\\IS415\\In-class_Ex\\In-class_Ex06\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n```\n:::\n\n```{.r .cell-code}\nglimpse(hunanGeo)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 88\nColumns: 8\n$ NAME_2     <chr> \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Changde\", \"Cha…\n$ ID_3       <int> 21098, 21100, 21101, 21102, 21103, 21104, 21109, 21110, 211…\n$ NAME_3     <chr> \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", \"L…\n$ ENGTYPE_3  <chr> \"County\", \"County\", \"County City\", \"County\", \"County\", \"Cou…\n$ Shape_Leng <dbl> 1.869074, 2.360691, 1.425620, 3.474325, 2.289506, 4.171918,…\n$ Shape_Area <dbl> 0.10056190, 0.19978745, 0.05302413, 0.18908121, 0.11450357,…\n$ County     <chr> \"Anxiang\", \"Hanshou\", \"Jinshi\", \"Li\", \"Linli\", \"Shimen\", \"L…\n$ geometry   <POLYGON [°]> POLYGON ((112.0625 29.75523..., POLYGON ((112.2288 …\n```\n:::\n:::\n\n\n## Combining data frames\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhunan_gdppc = left_join(hunanGeo, hunan2012) %>%\n  select(1:4, 7, 15)\n```\n:::\n\n\nNote that we keep columns *NAME_3* and *County* to double check that the left join was done correctly and that spelling is the same across the two columns.\n\n## Plotting a Choropleth map\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(hunan_gdppc)+\n  tm_fill(\"GDPPC\",\n          style = \"quantile\",\n          palette = \"Blues\",\n          title = \"GDP / cap\")+\n  tm_layout(main.title = \"Distribution of GDP per capita by \",\n          main.title.position = \"center\",\n          main.title.size = 1.2,\n          legend.height = 0.45,\n          legend.width = 0.35,\n          frame = TRUE)+\n  tm_borders(alpha = 0.5)+\n  tm_compass(type = \"8star\", size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.2)\n```\n\n::: {.cell-output-display}\n![](In-class_Ex06_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## Contiguity Neighbors Analysis\n\nUsing the Queen method\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncn_queen = hunan_gdppc %>%\n  mutate(nb = st_contiguity(geometry),\n         .before = 1)\n```\n:::\n\n\nUsing the Rooks method\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncn_rooks = hunan_gdppc %>%\n  mutate(nb = st_contiguity(geometry, queen = FALSE),\n         .before = 1)\n```\n:::\n\n\n## Computing Contiguity Weights\n\nUsing the Queen method\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwm_q = hunan_gdppc %>%\n  mutate(nb = st_contiguity(geometry),\n         wt = st_weights(nb),\n         .before = 1)\n```\n:::\n\n\nUsing the Rooks method\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwm_r = hunan_gdppc %>%\n  mutate(nb = st_contiguity(geometry),\n         queen = FALSE,\n         wt = st_weights(nb),\n         .before = 1)\n```\n:::\n",
    "supporting": [
      "In-class_Ex06_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}